# Config Language Translator

## Описание

Этот инструмент является транслятором для учебного конфигурационного языка, который преобразует входной текст в формате JSON в выходной текст на учебном конфигурационном языке. Он также поддерживает синтаксические ошибки с выдачей сообщений. Входной текст на языке JSON принимается из файла, а выходной текст записывается в файл, путь к которому задается через командную строку.

### Особенности синтаксиса:

1. **Однострочные комментарии**:
    - Все строки, начинающиеся с `!`, считаются комментариями. Например:
      ```
      ! Это однострочный комментарий
      ```

2. **Массивы**:
    - Массивы в языке задаются с помощью квадратных скобок и разделяются пробелами:
      ```
      [ значение значение значение ... ]
      ```

3. **Словари**:
    - Словари представлены с использованием фигурных скобок и разделяются символом `->`:
      ```
      {
          имя -> значение.
          имя -> значение.
          имя -> значение.
          ...
      }
      ```

4. **Имена**:
    - Имена переменных должны начинаться с буквы или подчеркивания, а затем могут содержать буквы, цифры и подчеркивания:
      ```
      [_a-zA-Z][_a-zA-Z0-9]*
      ```

5. **Значения**:
    - Значениями могут быть:
      - Числа.
      - Массивы.
      - Словари.

6. **Объявление константы на этапе трансляции**:
    - Константы объявляются с помощью ключевого слова `const`:
      ```
      const имя = значение;
      ```

7. **Вычисление константы на этапе трансляции**:
    - Для вычисления значений констант используется синтаксис:
      ```
      ?(имя)
      ```

## Формат входного файла

Входной файл должен быть в формате JSON. Пример структуры входного файла:

```json
{
  "constants": {
    "MAX_VALUE": 100,
    "PI": 3.14
  },
  "data": {
    "constant_example": "?(MAX_VALUE)"
  }
}
```

- **constants**: Объявление констант, которые могут быть использованы в данных.
- **data**: Пример использования констант с вычислением значений.

## Формат выходного файла

Выходной файл будет содержать преобразованные данные, используя синтаксис учебного конфигурационного языка. Пример выходного файла:

```text
{
    constant_example -> 100.
}
```

## Установка и сборка

1. Клонируйте репозиторий:
   ```bash
   git clone git@github.com:Dpanov2302/kisscm-3.git
   ```

2. Перейдите в каталог проекта:
   ```bash
   cd kisscm-3
   ```

3. Установки дополнительных зависимостей в текущем проекте не требуется.

## Использование

Для запуска программы используйте следующую команду:

```bash
python main.py <input_file> <output_file>
```

Где:
- `<input_file>` — путь к файлу с входными данными в формате JSON.
- `<output_file>` — путь к файлу, в который будет записан выходной конфигурационный текст.

### Пример:

```bash
python main.py input.json output.txt
```

## Тестирование

Для запуска тестов используйте фреймворк **unittest**. Тесты проверяют корректность парсинга, трансформации и обработки ошибок.

Для запуска тестов используйте следующую команду:

```bash
python -m unittest tests.py
```

## Результаты прогона тестов

Для проекта написаны тесты, покрывающие все функции эмулятора. Пример вывода тестов:

```bash
Ran 7 tests in 0.008s

OK
```

## Примеры конфигурации из разных предметных областей

Вот примеры входных JSON-файлов и соответствующих им выходных текстов.

### 1. Система управления умным домом

#### Входной файл:

```json
{
  "constants": {
    "DEFAULT_TEMP": 22,
    "MAX_LIGHT_LEVEL": 100
  },
  "devices": {
    "thermostat": {
      "mode": "cool",
      "temperature": "?(DEFAULT_TEMP)"
    },
    "lights": {
      "living_room": {
        "level": 75,
        "status": "on"
      },
      "bedroom": {
        "level": "?(MAX_LIGHT_LEVEL)",
        "status": "off"
      }
    }
  }
}
```

#### Выходной файл:

```text
{
    devices -> {
        thermostat -> {
            mode -> cool.
            temperature -> 22.
        }.
        lights -> {
            living_room -> {
                level -> 75.
                status -> on.
            }.
            bedroom -> {
                level -> 100.
                status -> off.
            }.
        }.
    }.
}
```

### 2. Конфигурация серверной инфраструктуры

#### Входной файл:

```json
{
  "constants": {
    "DEFAULT_PORT": 8080,
    "MAX_CONNECTIONS": 100
  },
  "servers": {
    "web_server": {
      "ip": "192.168.0.1",
      "port": "?(DEFAULT_PORT)",
      "max_connections": "?(MAX_CONNECTIONS)"
    },
    "db_server": {
      "ip": "192.168.0.2",
      "port": 3306,
      "backup": {
        "enabled": true,
        "schedule": "02:00"
      }
    }
  }
}
```

#### Выходной файл:

```text
{
    servers -> {
        web_server -> {
            ip -> 192.168.0.1.
            port -> 8080.
            max_connections -> 100.
        }.
        db_server -> {
            ip -> 192.168.0.2.
            port -> 3306.
            backup -> {
                enabled -> true.
                schedule -> 02:00.
            }.
        }.
    }.
}
```

### 3. Конфигурация системы управления проектами

#### Входной файл:

```json
{
  "constants": {
    "DEFAULT_PRIORITY": "medium"
  },
  "projects": {
    "project_alpha": {
      "tasks": [
        {
          "title": "Setup environment",
          "priority": "?(DEFAULT_PRIORITY)",
          "assignee": "Alice"
        },
        {
          "title": "Develop feature X",
          "priority": "high",
          "assignee": "Bob"
        }
      ]
    },
    "project_beta": {
      "tasks": [
        {
          "title": "Create documentation",
          "priority": "low",
          "assignee": "Charlie"
        }
      ]
    }
  }
}
```

#### Выходной файл:

```text
{
    projects -> {
        project_alpha -> {
            tasks -> [ 
                { 
                    title -> Setup environment. 
                    priority -> medium. 
                    assignee -> Alice. 
                } 
                { 
                    title -> Develop feature X. 
                    priority -> high. 
                    assignee -> Bob. 
                } 
            ].
        }.
        project_beta -> {
            tasks -> [ 
                { 
                    title -> Create documentation. 
                    priority -> low. 
                    assignee -> Charlie. 
                } 
            ].
        }.
    }.
}
```

## Заключение

Этот проект позволяет преобразовать данные из JSON-формата в учебный конфигурационный язык с поддержкой вычислений и констант на этапе трансляции. Все конструкции языка (включая массивы, словари и константы) поддерживаются и покрыты тестами.
